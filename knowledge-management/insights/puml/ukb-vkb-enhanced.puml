@startuml ukb-vkb-enhanced
!theme plain
skinparam backgroundColor white
skinparam defaultFontSize 9
skinparam maxMessageSize 40

title Enhanced UKB and VKB Commands - Traditional + AI Flows

== Traditional UKB Auto Mode ==

participant Dev as D
participant UKB as U
participant Git as G
participant Memory as M

D -> U: ukb --auto
activate U
U -> G: analyze commits
U -> U: score significance
U -> M: update entities
U --> D: ✅ updated (traditional)
deactivate U

== Enhanced AI Analysis Mode ==

participant Claude as C
participant MCP as MCP
participant SemanticAgent as SA
participant KnowledgeAgent as KG

D -> C: "Analyze this repository"
C -> MCP: analyze_repository tool
activate MCP
MCP -> SA: LLM-powered analysis
activate SA
SA -> SA: analyze 50 commits
SA -> KG: create 15 entities
activate KG
KG -> M: batch update
KG --> SA: ✅ entities created
deactivate KG
SA --> MCP: comprehensive results
deactivate SA
MCP --> C: "Found 15 patterns, 8 insights"
C --> D: ✅ AI analysis complete (10x faster)
deactivate MCP

== Traditional UKB Interactive Mode ==

D -> U: ukb --interactive
activate U
U -> D: structured prompts
note right: problem, solution,\nrationale, learnings
D -> U: expert knowledge
U -> U: high significance
U -> M: create insight
U --> D: ✅ captured (manual)
deactivate U

== AI-Enhanced Workflow Mode ==

D -> C: "Complete project analysis"
C -> MCP: start_workflow tool
activate MCP
MCP -> SA: repository analysis
MCP -> SA: web research
MCP -> KG: entity creation
MCP -> KG: relationship mapping
KG -> M: comprehensive update
MCP --> C: "25 insights, 12 patterns, 5 references"
C --> D: ✅ comprehensive analysis
deactivate MCP

== Enhanced VKB Server ==

participant VKB as V
participant Server as S
participant Browser as B
participant AIData as AI

D -> V: vkb start
activate V
V -> AI: enhanced data preparation
note right: Traditional + AI entities,\nenhanced relationships
V -> S: start http server
activate S
V -> B: open browser
B -> S: localhost:8080
S -> B: interactive graph\n(traditional + AI data)
note right: Color-coded:\nManual (blue), AI (green),\nPatterns (gold)
V --> D: ✅ enhanced visualization
deactivate V

== AI-Powered Search & Discovery ==

D -> B: search "performance patterns"
B -> S: intelligent search
S -> AI: enhanced matching
AI -> S: ranked results
note right: AI entities + traditional\nranked by relevance
S -> B: smart results
B --> D: enhanced discovery

@enduml