{
  "id": "complete-semantic-analysis",
  "name": "Complete Semantic Analysis Workflow",
  "description": "End-to-end semantic analysis including all agents: analysis, documentation, PlantUML, QA, and deduplication",
  "version": "1.0.0",
  "timeout": 1800000,
  "steps": [
    {
      "name": "semantic-analysis",
      "type": "agent-call",
      "config": {
        "agent": "semantic-analysis",
        "action": "analyzeRepository",
        "parameters": {
          "repository": "${context.repository}",
          "depth": "${context.depth}",
          "significanceThreshold": "${context.significanceThreshold}"
        }
      },
      "timeout": 600000,
      "outputMapping": {
        "insights": "result.insights",
        "patterns": "result.patterns",
        "entities": "result.entities"
      }
    },
    {
      "name": "web-search-enhancement",
      "type": "agent-call",
      "config": {
        "agent": "web-search",
        "action": "enhanceInsights",
        "parameters": {
          "insights": "${context.insights}",
          "patterns": "${context.patterns}"
        }
      },
      "timeout": 300000,
      "optional": true,
      "outputMapping": {
        "enhancedInsights": "result.enhancedInsights",
        "references": "result.references"
      }
    },
    {
      "name": "documentation-generation",
      "type": "agent-call",
      "config": {
        "agent": "documentation",
        "action": "generateInsightDocs",
        "parameters": {
          "entities": "${context.entities}",
          "insights": "${context.enhancedInsights}",
          "outputPath": "../knowledge-management/insights/"
        }
      },
      "timeout": 600000,
      "outputMapping": {
        "documentationFiles": "result.generatedFiles",
        "documentationLinks": "result.documentationLinks"
      }
    },
    {
      "name": "plantuml-generation",
      "type": "agent-call",
      "config": {
        "agent": "documentation",
        "action": "generatePlantUML",
        "parameters": {
          "entities": "${context.entities}",
          "patterns": "${context.patterns}",
          "outputPath": "../knowledge-management/puml/"
        }
      },
      "timeout": 300000,
      "outputMapping": {
        "plantUMLFiles": "result.plantUMLFiles",
        "diagramImages": "result.diagramImages"
      }
    },
    {
      "name": "knowledge-graph-update",
      "type": "agent-call",
      "config": {
        "agent": "knowledge-graph",
        "action": "updateWithDocumentationLinks",
        "parameters": {
          "entities": "${context.entities}",
          "documentationLinks": "${context.documentationLinks}",
          "plantUMLFiles": "${context.plantUMLFiles}"
        }
      },
      "timeout": 300000,
      "outputMapping": {
        "updatedEntities": "result.updatedEntities",
        "knowledgeGraphStats": "result.stats"
      }
    },
    {
      "name": "qa-validation",
      "type": "agent-call",
      "config": {
        "agent": "qa",
        "action": "validateCompleteness",
        "parameters": {
          "entities": "${context.updatedEntities}",
          "documentationFiles": "${context.documentationFiles}",
          "plantUMLFiles": "${context.plantUMLFiles}",
          "expectedTotal": "${context.expectedEntityCount}"
        }
      },
      "timeout": 300000,
      "outputMapping": {
        "validationReport": "result.validationReport",
        "missingDocumentation": "result.missingDocumentation",
        "brokenLinks": "result.brokenLinks"
      }
    },
    {
      "name": "deduplication",
      "type": "agent-call",
      "config": {
        "agent": "deduplication",
        "action": "analyzeAndMerge",
        "parameters": {
          "entities": "${context.updatedEntities}",
          "autoMerge": true,
          "threshold": 0.85
        }
      },
      "timeout": 300000,
      "outputMapping": {
        "deduplicationReport": "result.deduplicationReport",
        "mergedEntities": "result.mergedEntities",
        "duplicatesRemoved": "result.duplicatesRemoved"
      }
    },
    {
      "name": "synchronization",
      "type": "agent-call",
      "config": {
        "agent": "synchronization",
        "action": "syncAll",
        "parameters": {
          "entities": "${context.mergedEntities}",
          "syncTargets": ["mcp", "files", "graphology"]
        }
      },
      "timeout": 300000,
      "outputMapping": {
        "syncReport": "result.syncReport",
        "finalEntities": "result.finalEntities"
      }
    },
    {
      "name": "final-validation",
      "type": "agent-call",
      "config": {
        "agent": "qa",
        "action": "finalCompletionCheck",
        "parameters": {
          "entities": "${context.finalEntities}",
          "validationReport": "${context.validationReport}",
          "deduplicationReport": "${context.deduplicationReport}",
          "syncReport": "${context.syncReport}"
        }
      },
      "timeout": 180000,
      "outputMapping": {
        "completionReport": "result.completionReport",
        "completionPercentage": "result.completionPercentage",
        "remainingTasks": "result.remainingTasks"
      }
    }
  ],
  "conditions": [
    {
      "name": "check-completion-percentage",
      "field": "context.completionPercentage",
      "operator": "greater_than",
      "value": 95
    }
  ],
  "onCompletion": {
    "persistState": true,
    "generateReport": true,
    "notifyAgents": ["coordinator", "knowledge-graph"],
    "updateWorkflowState": {
      "lastCompletedAt": "${execution.completedAt}",
      "completionPercentage": "${context.completionPercentage}",
      "totalEntitiesProcessed": "${context.finalEntities.length}",
      "documentationGenerated": "${context.documentationFiles.length}",
      "plantUMLDiagrams": "${context.plantUMLFiles.length}",
      "duplicatesRemoved": "${context.duplicatesRemoved}"
    }
  },
  "onFailure": {
    "persistState": true,
    "generateErrorReport": true,
    "partialResults": true,
    "recovery": {
      "enabled": true,
      "resumeFromLastStep": true,
      "maxRetries": 3
    }
  },
  "metadata": {
    "category": "end-to-end-analysis",
    "priority": "high",
    "requiredAgents": [
      "semantic-analysis",
      "web-search",
      "documentation",
      "knowledge-graph",
      "qa",
      "deduplication",
      "synchronization"
    ],
    "estimatedDuration": "15-30 minutes",
    "resourceRequirements": {
      "memory": "high",
      "cpu": "medium",
      "disk": "medium"
    }
  }
}