{
  "enabled": true,
  "logEvents": true,
  "forwardToProcessor": true,
  "processorEndpoint": "http://localhost:8767/api/events",
  "timeout": 5000,
  
  "preHook": {
    "enabled": true,
    "blockOnViolations": true,
    "checkViolationQueue": true,
    "performRiskAssessment": true,
    "processorEndpoint": "http://localhost:8767/api/pre-check",
    "timeout": 2000,
    "fallbackMode": "warn"
  },

  "constraints": {
    "localChecks": [
      {
        "id": "unauthorized-git-ops",
        "pattern": "git\\s+(commit|push|merge|rebase)",
        "message": "Git operations require explicit permission. Ask the user before committing changes.",
        "severity": "critical",
        "enabled": true
      },
      {
        "id": "destructive-file-ops",
        "pattern": "rm\\s+-rf|delete|remove",
        "message": "Destructive file operations detected. Confirm with user before proceeding.",
        "severity": "critical", 
        "enabled": true
      },
      {
        "id": "network-operations",
        "pattern": "curl|wget|fetch|http",
        "tools": ["Bash"],
        "message": "Network operations require user awareness for security.",
        "severity": "warning",
        "enabled": true
      },
      {
        "id": "system-modifications",
        "pattern": "sudo|chmod\\s+777|chown",
        "message": "System-level modifications detected. Ensure user approval.",
        "severity": "critical",
        "enabled": true
      }
    ]
  },

  "riskAssessment": {
    "enabled": true,
    "thresholds": {
      "high": 0.7,
      "medium": 0.4,
      "low": 0.2
    },
    "factors": [
      {
        "type": "file_deletion",
        "weight": 0.8,
        "patterns": ["rm", "delete", "remove"]
      },
      {
        "type": "network_access", 
        "weight": 0.5,
        "patterns": ["curl", "wget", "fetch", "http"]
      },
      {
        "type": "system_modification",
        "weight": 0.9,
        "patterns": ["sudo", "chmod", "chown"]
      },
      {
        "type": "large_operation",
        "weight": 0.3,
        "inputSizeThreshold": 1000
      }
    ]
  },

  "suggestions": {
    "unauthorized-git-ops": [
      "Ask the user: 'Should I commit these changes?'",
      "Explain what changes will be committed before proceeding",
      "Consider using --dry-run to preview git operations"
    ],
    "destructive-file-ops": [
      "Confirm the specific files to be deleted with the user",
      "Suggest creating a backup before deletion", 
      "Use --interactive flag for step-by-step confirmation"
    ],
    "network-operations": [
      "Inform the user about the network request being made",
      "Verify the destination URL is expected and safe",
      "Ask permission for external network access"
    ],
    "system-modifications": [
      "Explain why system-level access is needed",
      "Ask for explicit permission for system changes",
      "Suggest less privileged alternatives if available"
    ]
  },

  "logging": {
    "hookEvents": "../logs/hook-events.jsonl",
    "hookErrors": "../logs/hook-errors.jsonl",
    "maxLogSize": "10MB",
    "logRetention": "7d"
  }
}