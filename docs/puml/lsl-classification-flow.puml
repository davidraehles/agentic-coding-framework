@startuml LSL Classification Flow
!include _standard-style.puml

title ReliableCodingClassifier - Three-Layer Classification System

start

:New Exchange\nReceived;

partition "**Layer 1: Path Analyzer**" {
  :Path-based Analysis\n& Session Detection;
  
  note right
    - Session continuation patterns
    - File operation detection
    - Path-based classification
    - Fast pre-filtering
  end note
  
  if (High Confidence\nPath Match?) then (yes)
    :Return Classification\n(path layer, <10ms);
    stop
  else (no)
    :Continue to\nKeyword Analysis;
  endif
}

partition "**Layer 2: Keyword Analysis**" {
  :Load Coding Keywords\nDictionary;
  
  note left
    scripts/coding-keywords.json
    - "serena", "codebase"
    - "debug", "implement"
    - "git", "npm", "build"
  end note
  
  :Analyze Content for\nCoding Terms;
  
  :Calculate Keyword\nScore & Confidence;
  
  if (High Confidence\nCoding Match?) then (yes)
    :Return CODING_INFRASTRUCTURE\n(keyword layer, ~1ms);
    stop
  elseif (Clear Non-Coding?) then (yes)
    :Return NOT_CODING\n(keyword layer, ~1ms);
    stop
  else (inconclusive)
    :Continue to\nSemantic Analysis;
  endif
}

partition "**Layer 3: Semantic Analysis**" {
  :Performance Check\n(LLM Available?);
  
  if (Performance\nCritical?) then (yes)
    :Use Cached Result\nor Skip;
  else (no)
    :Send to LLM for\nSemantic Understanding;
    
    note right
      1000-1500ms typical
      Deep content understanding
      Context-aware classification
    end note
    
    :Receive LLM\nClassification;
  endif
  
  :Return Final\nClassification\n(semantic layer);
}

:Performance Monitoring\n& Statistics Update;

:Route Content to\nAppropriate Project;

stop

@enduml
