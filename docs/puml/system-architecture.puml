@startuml system-architecture
!theme amiga
title Knowledge Management System Architecture

package "Knowledge Capture Layer" {
  [Git Repository] as git
  [Conversation Logs] as logs
  [UKB Command] as ukb
  [UKB-CLI (Node.js)] as ukbcli
  [Knowledge API] as kapi
  [Commit Analysis] as analysis
  [Semantic Analysis] as semantic
}

package "Data Storage Layer" {
  [shared-memory.json] as storage
  [.backups/] as backups
}

package "Visualization Layer" {
  [VKB Command] as vkb
  [VKB-CLI (Node.js)] as vkbcli
  [VKB Server Manager] as vkbserver
  [HTTP Server] as server
  [Memory Visualizer] as visualizer
  [Web Browser] as browser
}

package "MCP Integration" {
  [Coding Agent] as agent
  [MCP Memory Server] as mcp
}

git --> analysis : Commit data
logs --> semantic : Conversation data
analysis --> ukbcli : Extracted insights
semantic --> ukbcli : Pattern insights
ukb --> ukbcli : Delegates to
ukbcli --> kapi : Uses API
kapi --> storage : Knowledge graph updates
storage --> backups : Automated backups

storage --> vkbcli : Read memory data
vkb --> vkbcli : Delegates to
vkbcli --> vkbserver : Server management
vkbserver --> server : Start/manage server
server --> visualizer : Serve graph data
visualizer --> browser : Interactive visualization

agent <--> mcp : MCP operations
mcp <--> storage : Sync operations
agent --> ukb : Trigger knowledge capture
agent --> logs : Generate conversations

note right of storage : Authoritative data source\nGit-tracked for team sharing
note right of visualizer : Interactive D3.js graph\nColor-coded by entity type
note right of mcp : Persistent memory\nCross-session knowledge

@enduml