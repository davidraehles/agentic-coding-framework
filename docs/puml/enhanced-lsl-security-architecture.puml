@startuml enhanced-lsl-security-architecture
!include _standard-style.puml
!define TITLE Enhanced LSL Security Architecture

title TITLE

package "Security Layer - Zero Trust Model" {
  
  package "Enhanced Redaction System" as redaction {
    component [Pattern Matching Engine] as patterns <<security>>
    component [Context Analysis] as context <<security>>
    component [Unicode Normalization] as unicode <<security>>
    component [Bypass Detection] as bypass <<security>>
  }
  
  package "User Hash Generator" as userHash {
    component [SHA-256 Hasher] as hasher <<security>>
    component [Entropy Salt] as salt <<security>>
    component [Collision Prevention] as collision <<security>>
  }
  
  package "Multi-User Isolation" as isolation {
    component [Session Separation] as sessions <<security>>
    component [Data Encryption] as encryption <<security>>
    component [Access Control] as access <<security>>
  }
  
  database "Threat Intelligence" as threats <<storage>>
  database "Security Audit Log" as auditLog <<storage>>
  database "User Sessions" as userSessions <<storage>>
}

package "Content Processing Pipeline" {
  component [Raw Content] as raw <<external>>
  component [Processed Content] as processed <<core>>
  component [Session Storage] as storage <<storage>>
}

package "Monitoring & Alerting" {
  component [Enhanced Operational Logger] as logger <<util>>
  component [Security Dashboard] as dashboard <<api>>
  component [Alert System] as alerts <<api>>
}

' Security Flow
raw SYNC_LINE redaction
redaction SYNC_LINE userHash
userHash SYNC_LINE isolation
isolation SYNC_LINE processed
processed SYNC_LINE storage

' Internal redaction flow
patterns CONTROL_LINE context
context CONTROL_LINE unicode  
unicode CONTROL_LINE bypass
bypass DATA_LINE threats

' User hash flow
hasher CONTROL_LINE salt
salt CONTROL_LINE collision
collision DATA_LINE userSessions

' Isolation flow  
sessions CONTROL_LINE encryption
encryption CONTROL_LINE access
access DATA_LINE storage

' Monitoring flow
redaction DATA_LINE logger
userHash DATA_LINE logger
isolation DATA_LINE logger
logger DATA_LINE auditLog
logger DATA_LINE dashboard
dashboard ASYNC_LINE alerts

' Threat intelligence feedback
threats OPTIONAL_LINE patterns
auditLog OPTIONAL_LINE dashboard

note top of redaction : 98.3% Effectiveness\nReal-time Bypass Detection\nSub-millisecond Processing

note top of userHash : SHA-256 + Entropy\nCollision-free\nPrivacy Protected

note top of isolation : Strict Mode Enabled\nZero Cross-contamination\nEncryption at Rest

note bottom of threats : Known Attack Vectors\nSocial Engineering\nObfuscation Techniques

@enduml